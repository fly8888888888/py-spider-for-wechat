# 微信公众号爬虫 - 快速开始指南

## 🚀 一键启动

### 方法一：使用启动脚本（推荐）
```bash
python 启动爬虫.py
```
启动脚本会自动检查依赖并启动程序。

### 方法二：直接启动
```bash
python main.py
```

## 📋 系统要求

- **Python**: 3.7 或更高版本
- **操作系统**: Windows / macOS / Linux
- **浏览器**: Google Chrome（用于自动登录）

## ⚡ 快速使用流程

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 启动程序
```bash
python 启动爬虫.py
```

### 3. 登录方式选择

#### 🔥 自动登录（推荐）
1. 点击"自动登录"按钮
2. 等待Chrome浏览器打开
3. 扫码登录微信公众平台
4. 登录成功后自动填入token和cookie

#### 📝 手动登录（备用）
1. 手动访问 [微信公众平台](https://mp.weixin.qq.com/)
2. 登录后按F12打开开发者工具
3. 复制token和cookie到对应输入框

### 4. 配置爬取参数
- **公众号名称**: 输入要爬取的公众号名称
- **起始页码**: 推荐从0开始（最新文章）
- **爬取页数**: 根据需要设置（每页约5-10篇文章）
- **保存位置**: 选择文件保存目录
- **文件名**: 设置保存的文件名
- **关键词筛选**: 可选，用中文分号分隔

### 5. 开始爬取
点击"开始爬取"按钮，等待完成。

## 🚀 批量爬取功能（新增）

### 启动批量爬取工具
在主界面点击"批量爬取工具"按钮，打开专门的批量爬取界面。

### 批量爬取特点
- ✅ **多公众号支持**: 一次性配置多个公众号
- ✅ **时间范围筛选**: 精确设置开始和结束日期
- ✅ **多线程处理**: 提升爬取效率
- ✅ **进度可视化**: 实时显示每个公众号的处理状态
- ✅ **数据库存储**: 可选的SQLite数据库存储
- ✅ **文件导入导出**: 支持从文件批量导入公众号列表

### 批量爬取使用步骤

#### 1. 添加公众号
- **手动添加**: 在输入框中输入公众号名称，点击"添加"
- **文件导入**: 点击"从文件导入"，支持txt、json、csv格式
- **示例文件**: 项目中提供了`示例公众号列表.txt`作为参考

#### 2. 设置时间范围
- **日期选择**: 使用日期选择器设置开始和结束日期
- **快捷按钮**: 点击"最近7天"、"最近30天"、"最近90天"快速设置

#### 3. 配置高级选项
- **多线程**: 启用多线程爬取，设置线程数（1-10）
- **数据库存储**: 将结果保存到SQLite数据库
- **内容抓取**: 是否抓取文章详细内容（耗时较长）
- **页数限制**: 每个公众号最大爬取页数

#### 4. 设置输出
- **保存目录**: 选择结果文件保存位置
- **文件名前缀**: 设置输出文件的名称前缀

#### 5. 开始批量爬取
- 点击"开始爬取"按钮
- 实时查看每个公众号的处理进度
- 查看运行日志了解详细情况

## 📁 结果文件

爬取完成后会生成：
```
保存目录/
├── 文件名_日期/
│   ├── 文件名_爬取结果.csv  # 最终结果
│   └── raw/                # 中间文件（可删除）
│       ├── 文件名_url.csv
│       ├── 文件名_title.csv
│       ├── 文件名_content.csv
│       └── 文件名_real-time.csv
```

## 🔧 常见问题

### Q: 提示"ModuleNotFoundError"
**A**: 运行 `pip install -r requirements.txt` 安装依赖

### Q: 自动登录失败
**A**: 
1. 确保已安装Chrome浏览器
2. 检查网络连接
3. 使用手动登录作为备用方案

### Q: 爬取失败或无数据
**A**: 
1. 检查token和cookie是否正确
2. 确认公众号名称正确
3. 检查网络连接

### Q: Chrome浏览器无法启动
**A**: 
1. 更新Chrome到最新版本
2. 重启程序
3. 检查系统权限

## 💡 使用技巧

1. **首次使用**: 推荐先爬取少量页数测试
2. **大量爬取**: 建议分批进行，避免被限制
3. **关键词筛选**: 使用精确关键词提高匹配准确性
4. **定期更新**: 登录信息会自动缓存4天

## 📞 获取帮助

- 查看详细文档: `自动登录使用说明.md`
- 联系作者: wsz2002@foxmail.com
- 问题反馈: 提供详细的错误信息和操作步骤

---

**祝您使用愉快！** 🎉 